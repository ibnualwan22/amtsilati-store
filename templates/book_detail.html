<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ book.name }} - Amtsilati Store</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --primary-light: #818cf8;
            --secondary: #0ea5e9;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --dark: #0f172a;
            --gray-900: #111827;
            --gray-800: #1f2937;
            --gray-700: #374151;
            --gray-600: #4b5563;
            --gray-500: #6b7280;
            --gray-400: #9ca3af;
            --gray-300: #d1d5db;
            --gray-200: #e5e7eb;
            --gray-100: #f3f4f6;
            --gray-50: #f9fafb;
            --white: #ffffff;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--gray-50);
            color: var(--gray-900);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Animated Background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(99, 102, 241, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(14, 165, 233, 0.05) 0%, transparent 50%);
            z-index: -1;
        }

        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(229, 231, 235, 0.5);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1280px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--gray-600);
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .back-link:hover {
            background: var(--gray-100);
            color: var(--primary);
            transform: translateX(-4px);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
            box-shadow: var(--shadow-md);
        }

        .logo-text {
            font-size: 1.25rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            max-width: 1280px;
            margin: 0 auto;
            padding: 3rem 2rem;
            width: 100%;
        }

        .product-container {
            background: white;
            border-radius: 24px;
            box-shadow: var(--shadow-xl);
            overflow: hidden;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            animation: fadeInUp 0.6s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Product Image Section */
        .product-image-section {
            background: linear-gradient(135deg, var(--gray-50) 0%, var(--gray-100) 100%);
            padding: 3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .product-image-wrapper {
            width: 100%;
            max-width: 450px;
            height: 600px;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            position: relative;
            cursor: zoom-in;
            transition: transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .product-image-wrapper:hover {
            transform: scale(1.03);
        }

        .product-image-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .product-image-wrapper:hover img {
            transform: scale(1.1);
        }

        .no-image {
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--gray-400);
        }

        .no-image i {
            font-size: 5rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .image-badge {
            position: absolute;
            top: 1.5rem;
            left: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        /* Product Info Section */
        .product-info-section {
            padding: 3rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .product-category {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 1rem;
            display: inline-block;
        }

        .product-title {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--gray-900);
            margin-bottom: 1.5rem;
            line-height: 1.2;
        }

        .availability-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .availability-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1.25rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .available {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.1) 100%);
            color: #065f46;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .unavailable {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(220, 38, 38, 0.1) 100%);
            color: #991b1b;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .product-price {
            margin-bottom: 2rem;
        }

        .price-label {
            font-size: 0.875rem;
            color: var(--gray-500);
            margin-bottom: 0.5rem;
        }

        .price-value {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1;
        }

        .purchase-section {
            border-top: 2px solid var(--gray-100);
            padding-top: 2rem;
        }

        .section-title {
            font-size: 1.125rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--gray-900);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .purchase-links {
            display: grid;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .purchase-link {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            padding: 1rem 1.5rem;
            border-radius: 14px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            color: white;
            font-size: 0.9rem;
            position: relative;
            overflow: hidden;
        }

        .purchase-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transition: left 0.3s ease;
        }

        .purchase-link:hover::before {
            left: 100%;
        }

        .purchase-link:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .btn-shopee {
            background: linear-gradient(135deg, #ee4d2d 0%, #ff6838 100%);
        }

        .btn-whatsapp {
            background: linear-gradient(135deg, #25d366 0%, #128c7e 100%);
        }

        .btn-instagram {
            background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
        }

        .btn-tiktok {
            background: linear-gradient(135deg, #000000 0%, #333333 100%);
        }

        .btn-ongkir {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        }

        /* Features */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            margin-top: 3rem;
            padding-top: 3rem;
            border-top: 2px solid var(--gray-100);
        }

        .feature-card {
            text-align: center;
            padding: 1.5rem;
            border-radius: 16px;
            background: var(--gray-50);
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            background: white;
            box-shadow: var(--shadow-lg);
            transform: translateY(-4px);
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 1rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            box-shadow: 0 8px 16px rgba(99, 102, 241, 0.2);
        }

        .feature-card h4 {
            font-size: 1rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 0.5rem;
        }

        .feature-card p {
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        /* Related Section */
        .related-section {
            max-width: 1280px;
            margin: 4rem auto 0;
            padding: 0 2rem;
        }

        .related-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .related-header h2 {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
        }

        .related-header p {
            color: var(--gray-600);
        }

        /* Related Products Grid */
        .related-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .related-card {
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .related-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .related-image {
            width: 100%;
            height: 200px;
            background: var(--gray-100);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        .related-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .related-card:hover .related-image img {
            transform: scale(1.05);
        }

        .no-image-small {
            color: var(--gray-400);
            text-align: center;
        }

        .no-image-small i {
            font-size: 3rem;
        }

        .badge-small {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            padding: 0.25rem 0.75rem;
            background: rgba(239, 68, 68, 0.9);
            color: white;
            font-size: 0.75rem;
            font-weight: 600;
            border-radius: 9999px;
        }

        .related-content {
            padding: 1.25rem;
        }

        .related-content h4 {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--gray-900);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .related-price {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .btn-small {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            width: 100%;
            text-decoration: none;
            background: var(--primary);
            color: white;
        }

        .btn-small:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .btn-small.btn-disabled {
            background: var(--gray-200);
            color: var(--gray-500);
            cursor: not-allowed;
        }

        /* Footer */
        .footer {
            background: linear-gradient(180deg, rgba(249, 250, 251, 0) 0%, rgba(249, 250, 251, 1) 100%);
            padding: 4rem 0 2rem;
            margin-top: 6rem;
        }

        .footer-content {
            max-width: 1280px;
            margin: 0 auto;
            text-align: center;
            padding: 0 2rem;
        }

        .footer-logo {
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: var(--gray-600);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: var(--primary);
        }

        .footer-bottom {
            padding-top: 2rem;
            border-top: 1px solid var(--gray-200);
            color: var(--gray-500);
            font-size: 0.875rem;
        }

        /* Responsive */
        @media (max-width: 968px) {
            .product-container {
                grid-template-columns: 1fr;
            }

            .product-image-section {
                padding: 2rem;
            }

            .product-image-wrapper {
                max-width: 100%;
                height: 500px;
            }

            .product-title {
                font-size: 2rem;
            }

            .price-value {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                padding: 1rem;
            }

            .main-content {
                padding: 2rem 1rem;
            }

            .product-info-section {
                padding: 2rem;
            }

            .features-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .footer-links {
                flex-direction: column;
                gap: 1rem;
            }
            
            /* Related products 2 columns on mobile */
            .related-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
        }

        @media (max-width: 480px) {
            .related-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }
            
            .related-content h4 {
                font-size: 0.875rem;
            }
            
            .related-price {
                font-size: 1rem;
            }
            
            .btn-small {
                padding: 0.375rem 0.75rem;
                font-size: 0.75rem;
            }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.6s ease forwards;
            opacity: 0;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }

        .slide-in-left {
            animation: slideInLeft 0.8s ease forwards;
            opacity: 0;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-in-right {
            animation: slideInRight 0.8s ease forwards;
            opacity: 0;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        .modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(15, 23, 42, 0.6); /* --dark dengan opacity */
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    backdrop-filter: blur(8px);
    animation: fadeIn 0.3s ease;
}

.modal-content {
    background: var(--white);
    padding: 2.5rem;
    border-radius: 20px;
    box-shadow: var(--shadow-xl);
    width: 90%;
    max-width: 650px;
    position: relative;
    animation: fadeInUp 0.4s ease;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
    border-bottom: 1px solid var(--gray-200);
    padding-bottom: 1.5rem;
}

.modal-title {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--gray-800);
}

.close-button {
    background: transparent;
    border: none;
    font-size: 2.5rem;
    color: var(--gray-400);
    cursor: pointer;
    line-height: 1;
    transition: color 0.3s ease, transform 0.3s ease;
}

.close-button:hover {
    color: var(--danger);
    transform: rotate(90deg);
}

#whatsapp-form .form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
}

#whatsapp-form .form-group {
    display: flex;
    flex-direction: column;
}

#whatsapp-form label {
    font-weight: 600;
    font-size: 0.875rem;
    color: var(--gray-700);
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

#whatsapp-form input,
#whatsapp-form textarea {
    width: 100%;
    padding: 0.875rem 1rem;
    border: 2px solid var(--gray-200);
    border-radius: 10px;
    font-size: 1rem;
    font-family: 'Plus Jakarta Sans', sans-serif;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

#whatsapp-form input:focus,
#whatsapp-form textarea:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
}

#whatsapp-form textarea {
    resize: vertical;
}

/* --- CSS Responsif untuk Modal --- */
@media (max-width: 768px) {
    .modal-content {
        padding: 1.5rem;
    }
    #whatsapp-form .form-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    .modal-title {
        font-size: 1.25rem;
    }
}
@media (max-width: 968px) {
    .product-container {
        /* Ubah layout dari 2 kolom menjadi 1 kolom (menumpuk) */
        grid-template-columns: 1fr;
    }

    .product-image-section {
        padding: 2rem;
        min-height: 500px;
    }

    .product-image-wrapper {
        height: auto;
        max-height: 500px;
    }

    .product-title {
        font-size: 2rem;
    }

    .price-value {
        font-size: 2.5rem;
    }
}

/* --- Untuk Layar HP Sedang (di bawah 768px) --- */
@media (max-width: 768px) {
    .header-content {
        padding: 1rem;
    }

    .main-content {
        padding: 1.5rem 1rem;
    }

    .product-info-section {
        padding: 2rem 1.5rem;
    }

    /* Ubah fitur "100% Original", dll menjadi 1 kolom */
    .features-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    /* Buat "Kitab Lainnya" menjadi 2 kolom, mirip seperti di shop.html */
    .related-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
    }
}

/* --- Untuk Layar HP Kecil (di bawah 480px) --- */
@media (max-width: 480px) {
    .main-content {
        padding: 1rem 0.75rem;
    }

    .product-info-section {
        padding: 1.5rem;
    }

    .product-title {
        font-size: 1.75rem;
    }

    .price-value {
        font-size: 2.25rem;
    }

    /* Perkecil ukuran kartu di "Kitab Lainnya" */
    .related-grid {
        gap: 0.75rem;
    }
    
    .related-content h4 {
        font-size: 0.875rem;
    }
    
    .related-price {
        font-size: 1rem;
    }
    
    .btn-small {
        padding: 0.375rem 0.75rem;
        font-size: 0.75rem;
    }
}
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="/toko" class="back-link">
                <i class="fas fa-arrow-left"></i>
                <span>Kembali ke Katalog</span>
            </a>
            <a href="/" class="logo">
                <div class="logo-icon" style="background: transparent; box-shadow: none;">
                    <img src="/static/images/amtsilati-logo.png" alt="Amtsilati Store" style="width: 180%; height: 200%; object-fit: contain;">
                </div>
                <span class="logo-text">Amtsilati Store</span>
            </a>
        </div>
    </header>

    <main class="main-content">
        <div class="product-container">
            <div class="product-image-section slide-in-left">
                <div class="product-image-wrapper">
                    {% if book.image_filename %}
                        <img src="{{ url_for('uploaded_file', filename=book.image_filename) }}" alt="{{ book.name }}" onerror="this.onerror=null; this.src='https://placehold.co/450x600/e2e8f0/4a5568?text=Tidak+Ada+Gambar';">
                    {% else %}
                        <div class="no-image"><i class="fas fa-book"></i><p>Gambar tidak tersedia</p></div>
                    {% endif %}
                </div>
            </div>

            <div class="product-info-section slide-in-right">
                <div class="product-category">Kitab Pembelajaran</div>
                <h1 class="product-title">{{ book.name }}</h1>
                <div class="availability-info">
                    {% if book.availability == 'Tersedia' %}
                        <span class="availability-badge available"><i class="fas fa-check-circle"></i> Stok Tersedia</span>
                        <span style="color: var(--gray-500); font-size: 0.875rem;"><i class="fas fa-truck"></i> Siap dikirim</span>
                    {% else %}
                        <span class="availability-badge unavailable"><i class="fas fa-times-circle"></i> Stok Habis</span>
                    {% endif %}
                </div>
                <div class="product-price">
                    <div class="price-label">Harga</div>
                    <div class="price-value">Rp {{ book.price | rupiah }}</div>
                </div>

                <div class="purchase-section">
                    <h3 class="section-title"><i class="fas fa-shopping-bag"></i> Pilih Metode Pembelian</h3>
                    {% if book.availability == 'Tersedia' %}
                        
                        <div class="form-group" style="margin-bottom: 1.5rem; display: flex; align-items: center; gap: 1rem;">
                            <label for="quantity" style="font-weight: 600; font-size: 1rem;">Jumlah:</label>
                            <input type="number" id="quantity" value="1" min="1" style="padding: 0.5rem; width: 80px; border-radius: 8px; border: 2px solid var(--gray-200); font-size: 1rem; text-align: center;">
                        </div>

                        <div class="purchase-links">
                            <button id="open-order-modal-button" class="purchase-link btn-whatsapp">
                                 <i class="fab fa-whatsapp"></i> 
                                <span>Pesan via WhatsApp</span>
                              <i class="fas fa-external-link-alt" style="margin-left: auto; font-size: 0.75rem;"></i>
                            </button>

                        {% if book.link_shopee %}
                                <a href="{{ book.link_shopee }}" target="_blank" class="purchase-link btn-shopee">
                                    <i class="fas fa-shopping-bag"></i> <span>Beli di Shopee</span>
                                    <i class="fas fa-external-link-alt" style="margin-left: auto; font-size: 0.75rem;"></i>
                                </a>
                            {% endif %}
                            {% if book.link_ig %}
                                <a href="{{ book.link_ig }}" target="_blank" class="purchase-link btn-instagram">
                                    <i class="fab fa-instagram"></i> <span>Lihat di Instagram</span>
                                    <i class="fas fa-external-link-alt" style="margin-left: auto; font-size: 0.75rem;"></i>
                                </a>
                            {% endif %}
                            {% if book.link_tiktok %}
                                <a href="{{ book.link_tiktok }}" target="_blank" class="purchase-link btn-tiktok">
                                    <i class="fab fa-tiktok"></i> <span>Lihat di TikTok</span>
                                    <i class="fas fa-external-link-alt" style="margin-left: auto; font-size: 0.75rem;"></i>
                                </a>
                            {% endif %}
                            <a href="/cek-ongkir" class="purchase-link btn-ongkir">
                                <i class="fas fa-truck"></i> <span>Cek Estimasi Ongkos Kirim</span>
                                <i class="fas fa-calculator" style="margin-left: auto;"></i>
                            </a>
                        </div>
                    {% else %}
                        <div style="text-align: center; padding: 3rem 1rem; background: var(--gray-50); border-radius: 16px;">
                            <i class="fas fa-info-circle" style="font-size: 3rem; color: var(--gray-400); margin-bottom: 1rem; display: block;"></i>
                            <p style="color: var(--gray-600); font-weight: 500;">Maaf, kitab ini sedang tidak tersedia.</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </main>
    
     <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h4>100% Original</h4>
                        <p>Kitab asli berkualitas tinggi</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-shipping-fast"></i>
                        </div>
                        <h4>Pengiriman Cepat</h4>
                        <p>Kirim ke seluruh Indonesia</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-headset"></i>
                        </div>
                        <h4>Layanan 24/7</h4>
                        <p>Siap membantu Anda</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Related Products -->
    <section class="related-section fade-in">
        <div class="related-header">
            <h2>Kitab Lainnya</h2>
            <p>Temukan kitab pembelajaran lainnya yang mungkin Anda suka</p>
        </div>
        
        <div class="related-grid">
            {% for related_book in books %}
                {% if related_book.id != book.id and loop.index <= 4 %}
                <div class="related-card">
                    <div class="related-image">
                        {% if related_book.image_filename %}
                            <img src="{{ url_for('uploaded_file', filename=related_book.image_filename) }}" 
                                 alt="{{ related_book.name }}">
                        {% else %}
                            <div class="no-image-small">
                                <i class="fas fa-book"></i>
                            </div>
                        {% endif %}
                        {% if related_book.availability != 'Tersedia' %}
                            <span class="badge-small">Stok Habis</span>
                        {% endif %}
                    </div>
                    <div class="related-content">
                        <h4>{{ related_book.name }}</h4>
                        <p class="related-price">Rp {{ related_book.price | rupiah }}</p>
                        {% if related_book.availability == 'Tersedia' %}
                            <a href="{{ url_for('book_detail', book_id=related_book.id) }}" class="btn-small">
                                <i class="fas fa-eye"></i> Lihat
                            </a>
                        {% else %}
                            <button class="btn-small btn-disabled" disabled>
                                <i class="fas fa-times"></i> Habis
                            </button>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
            {% endfor %}
        </div>
    </section>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">
                <div class="logo-icon" style="background: transparent; box-shadow: none;">
    <img src="/static/images/amtsilati-logo.png" alt="Amtsilati Store" style="width: 100%; height: 100%; object-fit: contain;">
</div>
                <span style="font-weight: 700; font-size: 1.25rem;">Amtsilati Store</span>
            </div>
            
            <div class="footer-links">
                <a href="/tentang">Tentang Kami</a>
                <a href="/kontak">Kontak</a>
                <a href="/bantuan">Bantuan</a>
                <a href="/syarat-ketentuan">Syarat & Ketentuan</a>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 Amtsilati Store. Hak Cipta Dilindungi.</p>
                <p style="margin-top: 0.5rem;">
                    <a href="{{ url_for('login') }}" style="color: var(--gray-500); text-decoration: none;">
                        <i class="fas fa-user-shield"></i> Admin Login
                    </a>
                </p>
            </div>
        </div>
    </footer>
<div id="orderModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">Lengkapi Data Pemesanan</h2>
            <button id="closeModal" class="close-button">&times;</button>
        </div>
        
        <form id="whatsapp-form">
            <div class="form-grid">
                <div class="form-group">
                    <label for="customer-name"><i class="fas fa-user"></i> Nama Lengkap</label>
                    <input type="text" id="customer-name" placeholder="Masukkan nama Anda" required>
                </div>
                <div class="form-group">
                    <label for="customer-phone"><i class="fas fa-phone"></i> No. Handphone (WhatsApp)</label>
                    <input type="tel" id="customer-phone" placeholder="Contoh: 08123456789" required>
                </div>
                <div class="form-group" style="grid-column: 1 / -1;">
                    <label for="customer-address"><i class="fas fa-map-marker-alt"></i> Alamat Lengkap</label>
                    <textarea id="customer-address" rows="3" placeholder="Jalan, No. Rumah, RT/RW, Kelurahan, Kecamatan, Kota/Kabupaten" required></textarea>
                </div>
                <div class="form-group">
                    <label for="customer-zipcode"><i class="fas fa-envelope"></i> Kode Pos</label>
                    <input type="text" id="customer-zipcode" placeholder="Masukkan kode pos" required>
                </div>
            </div>
            <button type="submit" class="purchase-link btn-whatsapp" style="width: 100%; margin-top: 1.5rem;">
                <i class="fab fa-whatsapp"></i> Lanjutkan ke WhatsApp
            </button>
        </form>
    </div>
</div>
    <script>
document.addEventListener('DOMContentLoaded', function() {
    // --- Konfigurasi ---
    const phoneNumber = '6282332176464';
    const bookTitle = {{ book.name|tojson }};

    // --- Ambil Elemen dari Halaman ---
    const quantityInput = document.getElementById('quantity');
    const openModalButton = document.getElementById('open-order-modal-button');
    
    // Elemen Modal
    const orderModal = document.getElementById('orderModal');
    const closeModalButton = document.getElementById('closeModal');
    const whatsappForm = document.getElementById('whatsapp-form');

    // --- Fungsi untuk menampilkan & menyembunyikan Modal ---
    function showModal() {
        if (orderModal) orderModal.style.display = 'flex';
    }
    function hideModal() {
        if (orderModal) orderModal.style.display = 'none';
    }

    // --- Event Listener untuk membuka & menutup Modal ---
    if (openModalButton) {
        openModalButton.addEventListener('click', showModal);
    }
    if (closeModalButton) {
        closeModalButton.addEventListener('click', hideModal);
    }
    // Tutup modal jika klik di luar area kontennya
    window.addEventListener('click', function(event) {
        if (event.target == orderModal) {
            hideModal();
        }
    });


    // --- Event Listener untuk Form di dalam Modal ---
    if (whatsappForm) {
        whatsappForm.addEventListener('submit', function(event) {
            event.preventDefault(); // Mencegah form reload halaman

            // 1. Ambil semua data dari form modal
            const customerName = document.getElementById('customer-name').value;
            const customerPhone = document.getElementById('customer-phone').value;
            const customerAddress = document.getElementById('customer-address').value;
            const customerZipcode = document.getElementById('customer-zipcode').value;
            
            // 2. Ambil data jumlah dari halaman produk
            const quantity = quantityInput.value;

            // 3. Buat template pesan lengkap
            const messageTemplate = `
Terima kasih telah menghubungi Amtsilati Store. Silakan beri tahu apa yang dapat kami bantu.

Amtsilati store melayani pembelian semua kitab karya K.H. Taufiqul Hakim

Untuk order silahkan mengisi format di bawah ini 


Nama : ${customerName}
No Hp : ${customerPhone}
Alamat Lengkap : ${customerAddress}
Kode pos : ${customerZipcode}
Judul kitab : ${bookTitle}
Banyaknya : ${quantity}

Segera isi format di atas karena kami mengutamakan pelayanan untuk yang sudah mengisi format di atas

Setelah mengisi format akan kami totalkan plus info nomor rekening untuk pembayaranya
            `.trim();

            // 4. Encode pesan dan buat URL WhatsApp
            const encodedMessage = encodeURIComponent(messageTemplate);
            const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodedMessage}`;

            // 5. Buka WhatsApp di tab baru dan sembunyikan modal
            window.open(whatsappUrl, '_blank');
            hideModal();
            whatsappForm.reset(); // Kosongkan form setelah dikirim
        });
    }
});
</script>

</body>
</html>